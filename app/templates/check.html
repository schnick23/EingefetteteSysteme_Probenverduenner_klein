<!doctype html>
<html lang="de">

<head>
    <meta charset="utf-8">
    <title>Prüfseite</title>
    <meta name="viewport" content="width=device-width, initial-scale=2">
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f7f9fc/*#e3fcf0*/;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 90vh;
            margin: 0;
        }

        p {
            font-size: 20px;
            font-weight: 500;
            line-height: 1.5;
            margin-bottom: 0px;
        }

        ul {
            margin-top: 0px;
        }

        .page{
            min-width: 500px;
            max-width: 500px;
            box-shadow: 2px 2px 4px rgba(128, 128, 128, 0.358);
            border-radius: 10px;
            background-color: #ffffff;
            padding : 20px 40px 40px 40px;
            border-radius: 10px;
            font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
            font-size: 18px;
            color: #000000/*#2ECC71*/;

        }
        button{
            margin-top: 20px;
            padding: 10px;
            font-size: 16px;            
            border-radius: 5px;
            box-shadow: 0px 2px 4px rgba(128, 128, 128, 0.358);;
            cursor: pointer;
            border: none;
            width: 200px;
        }
        #button1:hover {
            background-color: #5e5e5ed0;
            color: white;
        }
        #button2:hover {
            background-color: #2ECC71;
            color: white
        }
        .button-group {
            display: flex;
            justify-content: space-between;
        }

    </style>
</head>

<body>
    <div class="page">
        <header class="page-header">
            <h1>Verdünnung bereit</h1>
        
        </header>

        <main class="page-main" style="margin-left: 30px;">
            
            <p>Reihe 1:</p>

            <ul>
                {% if info1 %}
                <li>Verdünnungsfaktor: {{ info1.Verduennung }}</li>
                <li>Endvolumen: {{ info1.Volumen|round(2) }} ml </li>
                {% endif %}

            </ul>
            <p>Reihe 2:</p>
            <ul>
                {% if info2 %}
                <li>Verdünnungsfaktor: {{ info2.Verduennung }}</li>
                <li>Endvolumen: {{ info2.Volumen|round(2) }} ml </li>
                {% endif %}
            </ul>
            <p>Reihe 3:</p>
            <ul>
                {% if info3 %}
                <li>Verdünnungsfaktor: {{ info3.Verduennung }}</li>
                <li>Endvolumen: {{ info3.Volumen|round(2) }} ml </li>
                {% endif %}
            </ul>
        </main>
                <div class="button-group">
                        <button id="button1" onclick="window.location.href='/'">Änderungen vornehmen</button>
                        <button id="button2">Starten</button>
                </div>
    </div>
        <script>
            (function(){
                const btn = document.getElementById('button2');
                const payload = {{ processed_json|safe }};
                btn.addEventListener('click', async () => {
                    try {
                        const res = await fetch('/api/confirm_start', {
                            method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ data: payload })
                        });
                        const out = await res.json();
                        if (res.ok && out && out.ok && out.task_id) {
                            window.location.href = '/running/' + encodeURIComponent(out.task_id);
                        } else {
                            alert('Start fehlgeschlagen');
                        }
                    } catch(e){ console.error(e); alert('Start fehlgeschlagen'); }
                });
            })();
        </script>
</body>

</html>